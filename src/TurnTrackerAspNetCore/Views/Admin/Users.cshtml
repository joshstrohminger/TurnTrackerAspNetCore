@model List<User>
@{
    ViewBag.Title = "Users";
    var errorMessage = ViewBag.ErrorMessage;
}
@if (!string.IsNullOrWhiteSpace(errorMessage))
{
    <div class="alert alert-danger alert-dismissible" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <strong>Error:</strong> @errorMessage
    </div>
}
<table class="table table-striped table-condensed">
    <thead>
    <tr>
        <th>UserName</th>
        <th>Display Name</th>
        <th>Roles</th>
        <th>Id</th>
        <th>Email</th>
        <th></th>
    </tr>
    </thead>
    @foreach (var user in Model)
    {
        <tr>
            <td>@user.UserName</td>
            <td>@user.DisplayName</td>
            <td>@string.Join(", ", user.Roles.Select(role => ViewBag.Roles[role.RoleId]))</td>
            <td>@user.Id</td>
            <td>@user.Email</td>
            <td class="clearfix">
                <div class="pull-right action-group">
                    @if (!user.EmailConfirmed)
                {
                        <form method="post" asp-action="ReSendConfirmationEmail" asp-antiforgery="true" asp-route-userid="@user.Id">
                            <button type="submit" class="btn btn-xs btn-primary">Re-Send Confirmation</button>
                        </form>
                    }
                    @if (ViewBag.MyUserId != user.Id)
                {
                        <a asp-action="EditUser" asp-route-id="@user.Id" class="btn btn-xs btn-success">
                            <span class="glyphicon glyphicon-pencil"></span>
                        </a>
                        <form asp-action="DeleteUser" asp-antiforgery="true" asp-route-id="@user.Id">
                            <button class="btn btn-xs btn-danger" type="submit">
                                <span class="glyphicon glyphicon-remove"></span>
                            </button>
                        </form>
                    }
                </div>
            </td>
        </tr>
    }
</table>